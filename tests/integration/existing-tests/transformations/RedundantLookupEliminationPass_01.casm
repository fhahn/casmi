// transform, cmdline "--rle"

CASM RedundantLookupElimination

init foo

function bar : -> Int initially { 0 }

function cnt : -> Int initially { 0 }

rule foo = 
{
    {|
        debuginfo out bar               // costs: 1 = LU(state)
        
        bar := bar + 1          // costs: 2 = LU(state) + UP
        
        debuginfo out bar               // costs: 1 = LU(local)
    |}
       
    cnt := cnt + 1

    if cnt = 12345678 then
        program(self) := undef
}

/*
rule foo = 
{
    local u0 = bar
    {|
        print u0__
        
        local u1__ := u0__ + 1
        bar := u1__
        
        print u1__
    |}
       
    program(self) := undef
}
*/

/*
rule foo = 
{
    local u0 = bar              
    {|
        print u0__
        
        local u1__ := u0__ + 1
        bar := u1__
        
        print u1__
    |}
       
    program(self) := undef
}
*/
